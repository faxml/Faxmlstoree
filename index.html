<!doctype html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Faxml Store</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;600;700;800&display=swap" rel="stylesheet">

<style>
:root{
  --bg0:#070913;
  --bg1:#0b1024;
  --stroke: rgba(255,255,255,.14);
  --text: rgba(255,255,255,.92);
  --muted: rgba(255,255,255,.68);
  --shadow: 0 20px 60px rgba(0,0,0,.45);
  --glow1: rgba(117, 83, 255, .35);
  --glow2: rgba(0, 255, 200, .18);
  --radius: 18px;
  --radius2: 26px;
  --max: 1120px;

  --safeTop: env(safe-area-inset-top, 0px);
  --safeBot: env(safe-area-inset-bottom, 0px);
}

*{ box-sizing:border-box; }
html{
  scroll-behavior:smooth;
  -webkit-text-size-adjust: 100%;
  text-rendering: optimizeLegibility;
  overflow-anchor: none; /* stop ‚Äúscroll sendiri‚Äù karena layout shift */
}
body{
  margin:0;
  font-family:"Manrope", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color: var(--text);
  background:
    radial-gradient(1200px 700px at 15% 10%, var(--glow1), transparent 55%),
    radial-gradient(900px 600px at 85% 15%, rgba(0, 210, 255, .20), transparent 55%),
    radial-gradient(800px 600px at 70% 85%, var(--glow2), transparent 55%),
    linear-gradient(180deg, var(--bg0), var(--bg1));
  min-height:100vh;
  overflow-x:hidden;
  background-size: 140% 140%, 160% 160%, 150% 150%, 100% 100%;
  background-position: 0% 0%, 100% 0%, 80% 100%, 0% 0%;
  animation: bgShift 18s ease-in-out infinite;

  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-overflow-scrolling: touch;
  touch-action: manipulation;
}
header, main{ position:relative; z-index:1; }
@keyframes bgShift{
  0%{ background-position: 0% 0%, 100% 0%, 80% 100%, 0% 0%; }
  50%{ background-position: 100% 30%, 0% 60%, 20% 0%, 0% 0%; }
  100%{ background-position: 0% 0%, 100% 0%, 80% 100%, 0% 0%; }
}

a{ color:inherit; text-decoration:none; }
a, button{ -webkit-tap-highlight-color: transparent; }
.container{ width:min(var(--max), calc(100% - 40px)); margin:0 auto; }
@media (max-width: 640px){
  .container{ width:min(var(--max), calc(100% - 24px)); }
}

.glass{
  background: linear-gradient(180deg, rgba(255,255,255,.11), rgba(255,255,255,.05));
  border: 1px solid var(--stroke);
  border-radius: var(--radius);
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
  box-shadow: var(--shadow);
}

.btn{
  display:inline-flex; align-items:center; justify-content:center;
  gap:10px;
  padding: 10px 14px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.16);
  background: rgba(255,255,255,.06);
  color: var(--text);
  font-weight: 900;
  font-size: 14px;
  transition: transform .18s cubic-bezier(.16,1,.3,1),
              background .18s ease,
              border-color .18s ease,
              color .18s ease;
  cursor:pointer;
  user-select:none;
  white-space:nowrap;
  will-change: transform;
  transform: translateZ(0);
}
.btn:hover{
  transform: translateY(-1px);
  background: rgba(255,255,255,.09);
  border-color: rgba(255,255,255,.22);
}
.btn.primary{
  border-color: rgba(117,83,255,.45);
  background: linear-gradient(135deg, rgba(117,83,255,.32), rgba(0,210,255,.18));
  box-shadow: 0 14px 40px rgba(117,83,255,.18);
}
.btn:disabled{ opacity:.55; cursor:not-allowed; transform:none !important; }

/* NAV */
.nav{ position: sticky; top: calc(14px + var(--safeTop)); z-index: 50; margin-top: 14px; }
.nav-inner{
  display:flex; align-items:center; justify-content:space-between;
  gap:12px; padding:12px 14px; border-radius:999px; min-width:0;
}
.brand{ display:flex; align-items:center; gap:10px; padding-left:6px; font-weight:900; flex: 1 1 auto; min-width:0; }
.brand-name{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.logo-wrap{
  width:38px; height:38px; border-radius:12px; overflow:hidden;
  flex:0 0 auto; border:1px solid rgba(255,255,255,.18);
  box-shadow:0 12px 30px rgba(117,83,255,.25); background: rgba(255,255,255,.06);
}
.logo-img{ width:100%; height:100%; display:block; object-fit: cover; }

.nav-links{ display:flex; gap:8px; align-items:center; justify-content:center; flex:1 1 auto; min-width:0; }
.nav-links a{
  padding:10px 12px; border-radius:999px; color: var(--muted);
  border:1px solid transparent; transition:.2s ease; font-weight:900; font-size:14px;
  white-space:nowrap;
}
.nav-links a:hover{ color: var(--text); background: rgba(255,255,255,.06); border-color: rgba(255,255,255,.10); }

.nav-cta{ display:flex; gap:10px; align-items:center; flex:0 0 auto; }
#beranda, #produk, #services, #faq{ scroll-margin-top: 110px; }
@media (max-width: 640px){ #beranda, #produk, #services, #faq{ scroll-margin-top: 150px; } }

.search{
  display:flex; align-items:center; gap:8px; padding: 8px 10px;
  border-radius: 999px; border: 1px solid rgba(255,255,255,.16);
  background: rgba(255,255,255,.06);
  width: clamp(160px, 22vw, 280px);
  max-width: 280px; min-width: 160px; flex: 0 1 auto; min-width:0;
}
.search input{
  width:100%; min-width:0; border:0; outline:none; background: transparent;
  color: var(--text); font: inherit; font-size: 14px;
}
.search input::placeholder{ color: rgba(255,255,255,.55); }
.search .s-clear{
  border:0; background: transparent; color: rgba(255,255,255,.8);
  cursor:pointer; padding: 0 6px; display:none; font-weight:900;
}
.search.has-value .s-clear{ display:block; }

.hamburger{
  display:none; width:42px; height:42px; border-radius:999px;
  border:1px solid rgba(255,255,255,.16); background: rgba(255,255,255,.06);
  align-items:center; justify-content:center; cursor:pointer; flex:0 0 auto;
}
.hamburger span{ width:18px; height:2px; background: rgba(255,255,255,.85); position:relative; display:block; border-radius:999px; }
.hamburger span::before,.hamburger span::after{
  content:""; position:absolute; left:0; width:18px; height:2px;
  background: rgba(255,255,255,.85); border-radius:999px;
}
.hamburger span::before{ top:-6px; }
.hamburger span::after{ top:6px; }

@media (max-width: 1100px){
  .nav-links{ display:none; }
  .nav-cta .btn:not(.primary){ display:none; }
  .hamburger{ display:flex; }
}
@media (max-width: 640px){
  .nav-inner{
    display:grid;
    grid-template-columns: 1fr auto;
    grid-template-areas: "brand cta" "search search";
    gap:10px;
    padding:12px;
    border-radius: var(--radius2);
  }
  .brand{ grid-area: brand; }
  .nav-cta{ grid-area: cta; justify-content:flex-end; }
  .search{ grid-area: search; width:100%; max-width:none; min-width:0; }
  .btn{ padding: 9px 12px; font-size:13px; }
  .hamburger{ width:40px; height:40px; }
}

/* HERO / SECTION */
.hero{ padding:44px 0 26px; }
.hero-grid{ display:grid; grid-template-columns: 1.1fr .9fr; gap:18px; align-items:stretch; }
.hero-card{ padding:26px; border-radius: var(--radius2); position:relative; overflow:hidden; }
.kicker{
  display:inline-flex; gap:10px; align-items:center;
  padding:8px 12px; border-radius:999px;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.05);
  color: var(--muted); font-weight:900; font-size:13px;
}
.dot{ width:8px; height:8px; border-radius:999px; background: rgba(0,255,200,.85); box-shadow: 0 0 22px rgba(0,255,200,.35); }
h1{ margin:14px 0 10px; font-size: clamp(30px, 4vw, 44px); line-height:1.1; letter-spacing:-0.6px; }
.sub{ margin:0 0 18px; color: var(--muted); font-size:16px; line-height:1.6; max-width:62ch; }
.type-cursor{ display:inline-block; margin-left:6px; opacity:.9; animation: blink .8s steps(1) infinite; }
@keyframes blink{ 50%{opacity:0;} }

/* kunci tinggi judul hero biar gak dorong produk (stop ‚Äúscroll sendiri‚Äù) */
#beranda .hero-card h1{ min-height: 3.6em; }
@media (min-width: 900px){
  #beranda .hero-card h1{ min-height: 2.4em; }
}

.showcase{ padding:18px; border-radius: var(--radius2); display:flex; flex-direction:column; gap:12px; }
.badge{
  display:inline-flex; align-items:center; gap:8px; padding:7px 10px;
  border-radius:999px; border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.04); color: var(--muted);
  font-weight:900; font-size:12px; width: fit-content;
}
.mini{ padding:14px; border-radius:18px; border:1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.04); }
.mini h3{ margin:0 0 6px; font-size:14px; }
.mini p{ margin:0; color: var(--muted); font-size:13px; line-height:1.5; }

section{ padding:18px 0 24px; }
.section-head{ display:flex; align-items:flex-end; justify-content:space-between; gap:18px; margin-bottom:14px; }
.section-head h2{ margin:0; font-size:22px; letter-spacing:-.2px; }
.section-head p{ margin:6px 0 0; color: var(--muted); max-width:64ch; line-height:1.6; font-size:14px; font-weight:700; }

/* Produk grid */
.grid{ display:grid; grid-template-columns: repeat(3, 1fr); gap:14px; }
@media (max-width: 980px){
  .hero-grid{ grid-template-columns: 1fr; }
  .grid{ grid-template-columns: repeat(2, 1fr); }
}
@media (max-width: 720px){
  .grid{ grid-template-columns: repeat(2, minmax(0, 1fr)); gap:12px; }
  .card{ min-width:0; }
}
@media (max-width: 380px){
  .grid{ grid-template-columns: 1fr; gap:10px; }
}

.card{
  padding:14px; border-radius: var(--radius);
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.04);
  transition: transform .22s cubic-bezier(.16,1,.3,1),
              background .22s ease,
              border-color .22s ease;
  position:relative; overflow:hidden;
  will-change: transform;
  transform: translateZ(0);
}
.card:hover{ transform: translateY(-2px); border-color: rgba(255,255,255,.18); background: rgba(255,255,255,.06); }

.product-thumb{
  position:relative; height:150px; border-radius:16px; overflow:hidden;
  border:1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.03); margin-bottom:12px;
}
.product-thumb img{ position:absolute; inset:0; width:100%; height:100%; object-fit:cover; z-index:1; }
.product-thumb::after{
  content:""; position:absolute; inset:0;
  background:
    radial-gradient(700px 220px at 20% 0%, rgba(255,255,255,.18), transparent 55%),
    linear-gradient(180deg, rgba(0,0,0,.25), rgba(0,0,0,.55));
  pointer-events:none; z-index:2;
}
.thumb-brand{
  position:absolute; left:14px; bottom:14px; z-index:3;
  font-weight:900; letter-spacing:.8px; text-transform: uppercase; font-size: 18px;
  opacity:.95; text-shadow: 0 12px 30px rgba(0,0,0,.55);
}
.stock-badge{
  position:absolute; top:12px; right:12px; z-index:4;
  padding:6px 10px; border-radius:10px; font-size:12px; font-weight:900;
  color:#fff; border:1px solid rgba(255,255,255,.14);
  background: rgba(34,197,94,.75); box-shadow: 0 10px 26px rgba(0,0,0,.25);
}
.stock-badge.habis{ background: rgba(239,68,68,.78); }

.tag{
  display:inline-flex; align-items:center; padding:6px 10px;
  border-radius:999px; border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.04); color: var(--muted);
  font-size:12px; font-weight:900; white-space:nowrap;
}
.product-top{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:6px; }
.product-sub{ margin:0 0 8px; color: rgba(255,255,255,.72); font-size:12px; font-weight:900; }
.card h3{ margin:8px 0 6px; font-size:16px; letter-spacing:-.2px; }
.card p{ margin:0 0 12px; color: var(--muted); font-size:13px; line-height:1.6; }

.price-row{ display:flex; align-items:center; justify-content:space-between; gap:10px; }
.price{ font-weight:900; letter-spacing:.2px; }
.tiny{ color: var(--muted); font-size:12px; margin-left:8px; font-weight:800; }

.btn-buy{
  width:100%; margin-top:12px; border-radius:12px; height:40px;
  font-weight:900;
}
.btn-buy.primaryish{
  border-color: rgba(29,107,255,.45);
  background: linear-gradient(180deg, rgba(29,107,255,.95), rgba(11,92,255,.95));
  box-shadow: 0 14px 40px rgba(29,107,255,.18);
}
.btn-buy.out{
  background: rgba(148,163,184,.18);
  border-color: rgba(148,163,184,.22);
  color: rgba(255,255,255,.75);
}

@media (max-width: 720px){
  .card{ padding: 12px; border-radius: 16px; }
  .product-thumb{ height: 128px; border-radius: 14px; }
  .thumb-brand{ font-size: 14px; left: 12px; bottom: 10px; }
  .stock-badge{ top: 10px; right: 10px; padding: 5px 8px; font-size: 11px; border-radius: 10px; }
  .product-sub{ white-space: nowrap; font-size: 11px; }
  .tag{ font-size: 11px; padding: 5px 8px; }
  .card h3{ font-size: 14px; line-height: 1.25; }
  .card p{ font-size: 12px; line-height: 1.55; margin-bottom: 10px; }
  .price-row > div{
    display:flex; align-items:baseline; gap:6px; flex-wrap:wrap; min-width:0;
  }
  .tiny{ white-space:nowrap; margin-left:0; }
  .btn-buy{ height: 38px; border-radius: 12px; }
}

/* MENU OVERLAY (sidebar background) */
.menu-overlay{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.55);
  display: none;
  z-index: 9998;
}
.menu-overlay.show{ display:block; }

/* MODAL */
.modal-overlay{
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  padding: 16px;
  background: rgba(0,0,0,.55);
  z-index: 9999;
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}
.modal-overlay.show{ display:flex; }

.modal{
  width: min(560px, 100%);
  max-height: min(86vh, 720px);
  border-radius: 18px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  will-change: transform;
  transform: translateZ(0);
}
.modal-header{
  flex: 0 0 auto;
  display:flex;
  align-items:center;
  justify-content: space-between;
  padding: 14px 16px;
  border-bottom: 1px solid rgba(255,255,255,.10);
}
.modal-header h2,
.modal-header h3{
  margin:0;
  font-size:16px;
  line-height:1.2;
  letter-spacing:-.2px;
}
.modal-close{
  background: transparent;
  border: none;
  color: rgba(255,255,255,.9);
  font-size: 18px;
  cursor: pointer;
  width: 38px;
  height: 38px;
  border-radius: 12px;
}
.modal-close:hover{ background: rgba(255,255,255,.06); }

.modal-body{
  flex: 1 1 auto;
  padding: 16px;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
}
.modal-body, .modal-body *{
  line-height:1.6;
  letter-spacing:.1px;
  word-break: break-word;
}
.modal-body p{
  margin: 10px 0;
  color: rgba(255,255,255,.78);
  font-size: 14px;
}

.modal-footer{
  flex: 0 0 auto;
  display:flex;
  gap:10px;
  padding:10px 12px;
  justify-content:space-between;
  align-items:center;
  padding-bottom: calc(10px + var(--safeBot));
  border-top: 1px solid rgba(255,255,255,.10);
  background: rgba(0,0,0,.18);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}
.modal-footer .btn{
  flex: 1 1 0;
  min-height: 42px;
  padding: 10px 12px;
  font-size: 13px;
  border-radius: 14px;
  white-space: nowrap;
  line-height: 1;
}
#cancelModal{ flex: .9 1 0; }
#sendBtn{ flex: 1.1 1 0; }

/* Form grid */
.form-grid{ display:grid; grid-template-columns: 1fr 1fr; gap: 12px; }
@media (max-width: 600px){ .form-grid{ grid-template-columns: 1fr; } }

.field{ margin-top: 12px; }
.field label{
  display:block;
  margin-bottom: 6px;
  font-size: 13px;
  font-weight: 900;
  color: rgba(255,255,255,.82);
}
.field input,
.field textarea,
.field select{
  width: 100%;
  padding: 10px 12px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.06);
  color: rgba(255,255,255,.92);
  outline: none;
  font: inherit;
  font-size: 14px;
  display:block;
}
.field input:focus,
.field textarea:focus,
.field select:focus{
  border-color: rgba(255,255,255,.22);
  box-shadow: 0 0 0 3px rgba(117,83,255,.20);
}
.field select{
  cursor:pointer;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  background-image:
    linear-gradient(45deg, transparent 50%, rgba(255,255,255,.85) 50%),
    linear-gradient(135deg, rgba(255,255,255,.85) 50%, transparent 50%);
  background-position:
    calc(100% - 18px) 50%,
    calc(100% - 12px) 50%;
  background-size: 6px 6px, 6px 6px;
  background-repeat: no-repeat;
  padding-right: 38px;
}
.field select option{ color:#111; background:#fff; }
.field input:disabled{
  opacity: 1;
  cursor: not-allowed;
  color: rgba(255,255,255,.82);
  -webkit-text-fill-color: rgba(255,255,255,.82);
  background: rgba(255,255,255,.04);
  border-color: rgba(255,255,255,.10);
  box-shadow: none;
}
.req{ color:#ff6b6b; }

/* RADIO */
.radio-row{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
  align-items:center;
  margin-top:6px;
}
.radio-item{
  display:inline-flex;
  align-items:center;
  gap:10px;
  min-height:40px;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.04);
}
.radio-item input[type="radio"]{
  width:18px;
  height:18px;
  accent-color:#7b5bff;
}
.radio-item label{
  margin:0;
  font-weight:900;
  font-size:14px;
  color:rgba(255,255,255,.86);
  white-space:nowrap;
  word-break:normal;
}
.radio-item:has(input[type="radio"]:checked){
  border-color: rgba(117,83,255,.45);
  background: rgba(117,83,255,.12);
}
@media (max-width: 640px){
  .radio-item{ flex: 0 0 calc(50% - 6px); min-width: 0; justify-content:flex-start; }
}
@media (max-width: 380px){
  .radio-item{ flex: 0 0 100%; }
}

/* Floating WhatsApp */
.pk-chat{
  position: fixed;
  right: 16px;
  bottom: calc(16px + var(--safeBot));
  width: 52px;
  height: 52px;
  border-radius: 999px;
  display:flex;
  align-items:center;
  justify-content:center;
  background: #25D366;
  border: none;
  box-shadow: 0 16px 40px rgba(0,0,0,.45);
  z-index: 999;
  transition: .2s ease;
}
.pk-chat:hover{ transform: translateY(-2px); }
.pk-chat .wa-ico{ width: 26px; height: 26px; color: #fff; }

/* FX Overlay */
.fx-overlay{
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  overflow: hidden;
}
.fx-overlay::before{
  content:"";
  position:absolute; inset:-10%;
  background:
    radial-gradient(900px 480px at 18% 12%, rgba(117,83,255,.16), transparent 60%),
    radial-gradient(850px 520px at 82% 18%, rgba(0,210,255,.12), transparent 62%),
    radial-gradient(900px 620px at 65% 88%, rgba(0,255,200,.10), transparent 62%),
    radial-gradient(1200px 900px at 50% 50%, rgba(0,0,0,.22), transparent 55%);
  filter: blur(2px);
  opacity: .95;
}
.fx-shimmer{
  position:absolute;
  inset:-40%;
  background:
    radial-gradient(closest-side, rgba(255,255,255,.10), transparent 70%),
    linear-gradient(120deg, transparent 40%, rgba(255,255,255,.06) 50%, transparent 60%);
  mix-blend-mode: screen;
  opacity: .55;
  animation: fxShimmer 12s ease-in-out infinite;
  will-change: transform;
}
@keyframes fxShimmer{
  0%{ transform: translate3d(-8%, -6%, 0) rotate(0deg); }
  50%{ transform: translate3d(10%, 6%, 0) rotate(10deg); }
  100%{ transform: translate3d(-8%, -6%, 0) rotate(0deg); }
}
.fx-particles{ position:absolute; inset:0; }
.fx-p{
  position:absolute;
  width: var(--s, 10px);
  height: var(--s, 10px);
  border-radius: 999px;
  left: var(--x, 50%);
  top: var(--y, 50%);
  opacity: var(--o, .35);
  background:
    radial-gradient(circle at 30% 30%, rgba(255,255,255,.55), rgba(255,255,255,0) 55%),
    radial-gradient(circle at 70% 70%, var(--c, rgba(117,83,255,.25)), rgba(0,0,0,0) 60%);
  filter: blur(var(--b, 0px));
  transform: translate3d(0,0,0);
  animation: fxFloat var(--d, 9s) ease-in-out infinite;
  will-change: transform, opacity;
}
@keyframes fxFloat{
  0%   { transform: translate3d(0, 0, 0) scale(1); opacity: var(--o, .35); }
  50%  { transform: translate3d(var(--dx, 14px), var(--dy, -60px), 0) scale(1.08); opacity: calc(var(--o, .35) + .12); }
  100% { transform: translate3d(0, 0, 0) scale(1); opacity: var(--o, .35); }
}
@media (prefers-reduced-motion: reduce){
  .fx-shimmer, .fx-p{ animation: none !important; }
}

/* HERO - FLOATING SMALL APP ICONS */
.hero-card{ position:relative; overflow:hidden; }
.app-float-wrap{
  position:absolute;
  right:16px;
  top:90px;
  width:160px;
  height:140px;
  pointer-events:none;
  z-index:1;
  opacity:.75;
}
.hero-card .kicker,
.hero-card h1,
.hero-card .sub{ position:relative; z-index:2; }
.app-float{
  position:absolute;
  width:26px; height:26px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(255,255,255,.04);
  display:grid; place-items:center;
  box-shadow:0 10px 24px rgba(0,0,0,.18);
  overflow:hidden;
  will-change:transform,opacity;
  transform: translateZ(0);
}
.app-float img{ width:76%; height:76%; object-fit:contain; display:block; }
@keyframes appDrift{
  0%,100%{ transform:translate3d(0,0,0) rotate(var(--rot)); opacity:var(--op); }
  50%{ transform:translate3d(var(--dx),var(--dy),0) rotate(calc(var(--rot) + 8deg)); opacity:calc(var(--op) - .12); }
}
.app-float.a1{ left:92px; top:6px;   --dx:6px;  --dy:-10px; --rot:-10deg; --op:.60; animation:appDrift 4.8s ease-in-out infinite; }
.app-float.a2{ left:124px;top:26px;  --dx:-8px; --dy:-12px; --rot:10deg;  --op:.52; animation:appDrift 5.6s ease-in-out infinite; }
.app-float.a3{ left:70px; top:30px;  --dx:8px;  --dy:-10px; --rot:-6deg;  --op:.55; animation:appDrift 4.4s ease-in-out infinite; }
.app-float.a4{ left:108px;top:56px;  --dx:-6px; --dy:-10px; --rot:12deg;  --op:.48; animation:appDrift 6.0s ease-in-out infinite; }
.app-float.a5{ left:40px; top:14px;  --dx:7px;  --dy:-12px; --rot:6deg;   --op:.45; animation:appDrift 6.3s ease-in-out infinite; }
.app-float.a6{ left:18px; top:50px;  --dx:-7px; --dy:-9px;  --rot:-12deg; --op:.42; animation:appDrift 5.0s ease-in-out infinite; }
.app-float.a7{ left:56px; top:72px;  --dx:6px;  --dy:-10px; --rot:10deg;  --op:.40; animation:appDrift 6.8s ease-in-out infinite; }
.app-float.a8{ left:132px;top:84px;  --dx:8px;  --dy:-10px; --rot:-8deg;  --op:.38; animation:appDrift 5.2s ease-in-out infinite; }
@media (max-width:640px){
  .app-float-wrap{ right:12px; top:110px; width:140px; height:120px; opacity:.85; }
  .app-float{ width:22px; height:22px; border-radius:8px; }
}
@media (prefers-reduced-motion: reduce){ .app-float{ animation:none!important; } }

/* SERVICE + FAQ + FOOTER */
.service-grid{ display:grid; grid-template-columns: repeat(3, 1fr); gap:14px; }
@media (max-width: 980px){ .service-grid{ grid-template-columns: 1fr; } }

.faq-grid{ display:grid; grid-template-columns: 1fr 1fr; gap:14px; }
@media (max-width: 980px){ .faq-grid{ grid-template-columns: 1fr; } }

.faq-item{ padding:0; }
.faq-btn{
  width:100%;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  padding:14px 14px;
  border-radius: var(--radius);
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.04);
  cursor:pointer;
  font: inherit;
  color: var(--text);
  font-weight:900;
  text-align:left;
  transition: transform .18s cubic-bezier(.16,1,.3,1),
              background .18s ease,
              border-color .18s ease;
  will-change: transform;
  transform: translateZ(0);
}
.faq-btn:hover{
  background: rgba(255,255,255,.06);
  border-color: rgba(255,255,255,.18);
}
.faq-ico{
  width:34px; height:34px;
  border-radius: 12px;
  display:grid; place-items:center;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.04);
  flex:0 0 auto;
  font-weight:900;
}
.faq-panel{
  display:none;
  padding: 0 14px 14px 14px;
  color: var(--muted);
  line-height:1.65;
  font-weight:800;
}
.faq-item.open .faq-panel{ display:block; }
.faq-item.open .faq-ico{
  background: rgba(117,83,255,.14);
  border-color: rgba(117,83,255,.35);
}

/* FOOTER */
.footer-wrap{ margin-top: 28px; padding: 18px; border-radius: var(--radius2); }
.footer-top{
  display:grid;
  grid-template-columns: 1.4fr 1fr 1fr 1.2fr;
  gap:18px;
  align-items:start;
}
@media (max-width: 980px){ .footer-top{ grid-template-columns: 1fr 1fr; } }
@media (max-width: 640px){ .footer-top{ grid-template-columns: 1fr; gap:14px; } }

.f-brand{ display:flex; gap:12px; align-items:flex-start; }
.f-logo{
  width:44px; height:44px;
  border-radius: 14px;
  border:1px solid rgba(255,255,255,.16);
  overflow:hidden;
  flex:0 0 auto;
  background: rgba(255,255,255,.06);
}
.f-logo img{ width:100%; height:100%; object-fit:cover; display:block; }
.f-title{ font-weight:900; font-size:18px; margin:0 0 8px; }
.f-note{ margin:0; color: var(--muted); font-weight:800; font-size:13px; line-height:1.6; }

.f-col h4{
  margin: 2px 0 10px;
  font-size:12px;
  letter-spacing: .18em;
  text-transform: uppercase;
  color: rgba(255,255,255,.75);
  font-weight:900;
}
.f-links a{
  display:block;
  padding:8px 0;
  color: rgba(255,255,255,.72);
  font-weight:900;
  border-radius: 10px;
  transition: .2s ease;
}
.f-links a:hover{
  color: var(--text);
  background: rgba(255,255,255,.05);
  padding-left: 10px;
}
.footer-line{ margin:14px 0; height:1px; background: rgba(255,255,255,.10); }
.footer-bottom{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:14px;
  flex-wrap:wrap;
  color: rgba(255,255,255,.72);
  font-weight:900;
}
.footer-badges{
  display:flex;
  gap:10px;
  align-items:center;
  flex-wrap:wrap;
}
.f-badge{
  display:inline-flex;
  align-items:center;
  gap:10px;
  padding:10px 12px;
  border-radius: 14px;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.04);
  color: rgba(255,255,255,.80);
  font-weight:900;
}
.f-badge span{
  width:22px; height:22px;
  border-radius: 8px;
  display:grid; place-items:center;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.04);
}
.f-social{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:10px;
}
.f-social a{
  display:flex;
  align-items:center;
  gap:10px;
  padding:10px 12px;
  border-radius: 14px;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.04);
  color: rgba(255,255,255,.85);
  font-weight:900;
  transition: transform .18s cubic-bezier(.16,1,.3,1),
              background .18s ease,
              border-color .18s ease;
  min-height:44px;
  will-change: transform;
  transform: translateZ(0);
}
.f-social a:hover{
  transform: translateY(-1px);
  background: rgba(255,255,255,.06);
  border-color: rgba(255,255,255,.18);
  color: var(--text);
}
.f-social .ico{ width:28px; height:28px; border-radius:10px; overflow:hidden; display:grid; place-items:center; }
.f-social .ico img{ width:100%; height:100%; object-fit: contain; display:block; }
@media (max-width: 360px){ .f-social{ grid-template-columns: 1fr; } }

/* SIDEBAR */
#mobileMenu{
  position: fixed;
  top: 0;
  right: 0;
  width: min(360px, 88vw);
  height: 100vh;
  z-index: 9999;

  background: rgba(8, 10, 22, .48);
  -webkit-backdrop-filter: blur(20px) saturate(155%);
  backdrop-filter: blur(20px) saturate(155%);

  border-left: 1px solid rgba(255,255,255,.14);
  box-shadow: -22px 0 80px rgba(0,0,0,.72);

  padding: 14px;
  padding-top: calc(14px + var(--safeTop));
  padding-bottom: calc(14px + var(--safeBot));
  border-radius: 0;

  transform: translateX(112%);
  transition: transform .32s cubic-bezier(.16,1,.3,1);
  display: flex;
  flex-direction: column;
  gap: 12px;
  overflow: hidden;
  overscroll-behavior: contain;
  -webkit-overflow-scrolling: touch;

  will-change: transform;
  transform: translateX(112%) translateZ(0);
}
#mobileMenu::before{
  content:"";
  position:absolute;
  inset:-25%;
  pointer-events:none;
  background:
    radial-gradient(620px 380px at 18% 16%, rgba(117,83,255,.26), transparent 62%),
    radial-gradient(560px 360px at 92% 22%, rgba(0,210,255,.18), transparent 64%),
    radial-gradient(560px 420px at 70% 92%, rgba(0,255,200,.12), transparent 66%),
    linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,0));
  opacity: .9;
  filter: blur(2px);
}
#mobileMenu::after{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,0) 40%, rgba(0,0,0,.10));
  opacity:.55;
}
#mobileMenu > *{ position:relative; z-index:1; }
#mobileMenu.open{ transform: translateX(0) translateZ(0); }

#mobileMenu .mobile-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  padding: 10px 10px 14px;
  border-bottom: 1px solid rgba(255,255,255,.10);
}
#mobileMenu .mobile-title{
  display:flex;
  align-items:center;
  gap:10px;
  font-weight: 900;
  font-size: 16px;
  letter-spacing: -.2px;
  color: rgba(255,255,255,.92);
  text-shadow: 0 10px 28px rgba(0,0,0,.35);
}
#mobileMenu .mobile-close{
  width: 42px;
  height: 42px;
  border-radius: 14px;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  color: rgba(255,255,255,.92);
  font-size: 20px;
  cursor:pointer;
  transition: .2s ease;
}
#mobileMenu .mobile-close:hover{
  background: rgba(255,255,255,.10);
  transform: translateY(-1px);
}
#mobileMenu .mobile-links{
  padding: 8px 6px;
  display:flex;
  flex-direction: column;
  gap: 10px;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
}
#mobileMenu .mobile-links a{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  padding: 14px 14px;
  border-radius: 16px;
  background: rgba(255,255,255,.05);
  border: 1px solid rgba(255,255,255,.12);
  color: rgba(255,255,255,.92);
  font-weight: 900;
  font-size: 15px;
  letter-spacing: -.1px;
  transition: transform .18s cubic-bezier(.16,1,.3,1),
              background .18s ease,
              border-color .18s ease;
  position:relative;
  overflow:hidden;
  -webkit-tap-highlight-color: transparent;
  will-change: transform;
  transform: translateZ(0);
}
#mobileMenu .mobile-links a::before{
  content:"";
  position:absolute;
  inset:-2px;
  background:
    radial-gradient(260px 140px at 0% 50%, rgba(117,83,255,.22), transparent 55%),
    radial-gradient(260px 140px at 100% 50%, rgba(0,210,255,.16), transparent 55%);
  opacity: .22;
  transition: opacity .2s ease;
}
#mobileMenu .mobile-links a span{ position:relative; z-index:1; }
#mobileMenu .mobile-links a .arrow{
  width: 36px;
  height: 36px;
  border-radius: 14px;
  display:grid;
  place-items:center;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(0,0,0,.12);
  color: rgba(255,255,255,.92);
  font-weight: 900;
  line-height: 1;
  opacity:.95;
  transform: translateX(0);
  transition: transform .2s ease, background .2s ease, border-color .2s ease;
}
#mobileMenu .mobile-links a:hover{
  transform: translateY(-1px);
  border-color: rgba(255,255,255,.18);
  background: rgba(255,255,255,.07);
}
#mobileMenu .mobile-links a:hover::before{ opacity: .9; }
#mobileMenu .mobile-links a:hover .arrow{
  transform: translateX(2px);
  background: rgba(255,255,255,.06);
  border-color: rgba(255,255,255,.18);
}
#mobileMenu .mobile-actions{
  padding: 12px 6px 6px;
  border-top: 1px solid rgba(255,255,255,.10);
  display:flex;
  flex-direction: column;
  gap: 10px;
}
#mobileMenu .mobile-actions .btn{
  width: 100%;
  border-radius: 16px;
  min-height: 46px;
  justify-content:center;
  font-weight: 900;
}
#mobileMenu .mobile-actions .btn.primary{
  border-color: rgba(117,83,255,.55);
  background: linear-gradient(135deg, rgba(117,83,255,.36), rgba(0,210,255,.22));
  box-shadow: 0 16px 50px rgba(117,83,255,.20);
}

/* QRIS OVERLAY */
.qris-view{
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  padding: 16px;
  background: rgba(0,0,0,.65);
  z-index: 10000;
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}
.qris-view.show{ display:flex; }
.qris-box{
  position: relative;
  width: min(520px, 100%);
  border-radius: 18px;
  padding: 12px;
  overflow: hidden;
}
.qris-x{
  position: absolute;
  top: 10px;
  right: 10px;
  width: 40px;
  height: 40px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,.16);
  background: rgba(0,0,0,.35);
  color: rgba(255,255,255,.92);
  font-size: 22px;
  line-height: 1;
  cursor: pointer;
}
.qris-x:hover{ background: rgba(255,255,255,.08); }
.qris-img-big{
  width: 100%;
  height: auto;
  display:block;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.03);
}

/* biar card ga ketutup tombol WA */
main.container{ padding-bottom: 90px; }

/* ===== PERF MOBILE (tetap ada overlay & icon, tapi lebih ringan) ===== */
@media (max-width: 768px){
  /* background anim besar sering bikin ‚Äúngerem‚Äù */
  body{ animation: none !important; }

  /* shimmer saja dimatikan, overlay + partikel tetap ada */
  .fx-shimmer{ animation: none !important; }

  /* blur fixed/sticky bisa bikin stutter -> matikan, ganti solid */
  .glass, .nav-inner, .modal-overlay, .modal, .modal-footer, #mobileMenu, .qris-view, .qris-box{
    -webkit-backdrop-filter: none !important;
    backdrop-filter: none !important;
  }
  .glass, .nav-inner{ background: rgba(10,14,30,.82) !important; }

  #mobileMenu{ background: rgba(8,10,22,.92) !important; }

  /* kurangi hover transform (mobile gak perlu) */
  .card:hover, .btn:hover, .faq-btn:hover, .f-social a:hover{ transform:none !important; }

  /* kurangi will-change */
  .card, .btn, .faq-btn, #mobileMenu, .modal{ will-change: auto !important; }
}

/* Reduce motion */
@media (prefers-reduced-motion: reduce){
  *{ animation: none !important; transition: none !important; scroll-behavior:auto !important; }
}
/* ===== LOADING sebelum QRIS muncul ===== */
.loading-view{
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  padding: 16px;
  background: rgba(0,0,0,.65);
  z-index: 10020; /* di atas modal */
}
.loading-view.show{ display:flex; }

.loading-card{
  width: min(380px, 100%);
  padding: 18px 16px;
  border-radius: 18px;
  text-align: center;
}

.loading-spinner{
  width: 46px;
  height: 46px;
  border-radius: 999px;
  border: 4px solid rgba(255,255,255,.18);
  border-top-color: rgba(117,83,255,.95);
  animation: spin .8s linear infinite;
  margin: 0 auto 12px;
}
@keyframes spin{ to{ transform: rotate(360deg); } }

.loading-title{
  margin: 0 0 4px;
  font-weight: 900;
}
.loading-sub{
  margin: 0;
  color: rgba(255,255,255,.72);
  font-weight: 800;
  font-size: 13px;
  line-height: 1.5;
}

/* ===== LOADING di tombol "Lanjut Pembayaran" ===== */
.btn.is-loading{
  pointer-events: none;
  opacity: .9;
}
.btn .btn-spin{
  width: 16px;
  height: 16px;
  border-radius: 999px;
  border: 3px solid rgba(255,255,255,.25);
  border-top-color: rgba(255,255,255,.92);
  animation: spin .7s linear infinite;
}

@media (prefers-reduced-motion: reduce){
  .loading-spinner,
  .btn .btn-spin{ animation:none !important; }
}
/* ===== SMOOTH PATCH V2 (anti bentrok + lebih ringan di mobile) ===== */

/* jangan pakai CSS smooth (biar JS yang handle) */
html{ scroll-behavior: auto !important; }

/* lighten animasi berat di mobile */
@media (max-width: 768px){
  /* matikan gerak yang bikin stutter */
  .fx-p{ animation: none !important; }
  .app-float{ animation: none !important; }

  /* blur filter overlay juga berat */
  .fx-overlay::before{ filter: none !important; opacity: .85; }

  /* sedikit ringankan shadow */
  .glass{ box-shadow: 0 12px 34px rgba(0,0,0,.38) !important; }
}
/* card tetap sejajar */
.card{
  display:flex;
  flex-direction:column;
  height:100%;
}

/* batasi judul max 2 baris TANPA line-clamp */
.card h3{
  line-height: 1.25;
  max-height: calc(1.25em * 2); /* 2 baris */
  overflow: hidden;
}

/* batasi deskripsi max 3 baris TANPA line-clamp */
.card p{
  line-height: 1.55;
  max-height: calc(1.55em * 3); /* 3 baris */
  overflow: hidden;
}

/* dorong harga+detail+button ke bawah biar sejajar */
.price-row{ margin-top:auto; }
</style>
</head>

<body>
  <header class="nav container" id="topNav">
    <div class="nav-inner glass">
      <a class="brand" href="#beranda" aria-label="Ke Beranda">
        <span class="logo-wrap" aria-hidden="true">
          <img class="logo-img" src="img/logo.png" alt="">
        </span>
        <span class="brand-name">Faxml Store</span>
      </a>

      <nav class="nav-links" aria-label="Navigasi utama">
        <a href="#beranda">Beranda</a>
        <a href="#produk">Produk</a>
        <a href="#services">Service</a>
        <a href="#faq">FAQ</a>
      </nav>

      <div class="search" role="search">
        <input id="searchInput" type="search" placeholder="Cari produk..." autocomplete="off">
        <button class="s-clear" id="searchClear" type="button" aria-label="Hapus">‚úï</button>
      </div>

      <div class="nav-cta">
        <a class="btn" href="#produk" title="Lihat katalog">Katalog</a>
        <button class="hamburger" id="hamburger" aria-label="Buka menu" aria-expanded="false">
          <span></span>
        </button>
      </div>
    </div>
  </header>

  <!-- OVERLAY (sidebar) -->
  <div id="menuOverlay" class="menu-overlay" aria-hidden="true"></div>

  <!-- SIDEBAR -->
  <aside id="mobileMenu" aria-label="Menu mobile">
    <div class="mobile-head">
      <div class="mobile-title">Menu</div>
      <button class="mobile-close" id="mobileClose" type="button" aria-label="Tutup">‚úï</button>
    </div>

    <div class="mobile-links" role="navigation" aria-label="Navigasi mobile">
      <a href="#beranda"><span>Beranda</span><span class="arrow">‚Ä∫</span></a>
      <a href="#produk"><span>Produk</span><span class="arrow">‚Ä∫</span></a>
      <a href="#services"><span>Service</span><span class="arrow">‚Ä∫</span></a>
      <a href="#faq"><span>FAQ</span><span class="arrow">‚Ä∫</span></a>
    </div>

    <div class="mobile-actions">
      <a class="btn primary" href="#produk">Lihat Produk</a>
    </div>
  </aside>

  <main class="container">
    <!-- HERO -->
    <section class="hero" id="beranda">
      <div class="hero-grid">
        <div class="hero-card glass">
          <div class="kicker"><span class="dot"></span> Marketplace Aplikasi Premium ‚Ä¢ Murah & Garansi</div>

          <div class="app-float-wrap" aria-hidden="true">
            <span class="app-float a1"><img src="img/logonet.png" alt=""></span>
            <span class="app-float a2"><img src="img/logocan.png" alt=""></span>
            <span class="app-float a3"><img src="img/logospo.png" alt=""></span>
            <span class="app-float a4"><img src="img/logocap.png" alt=""></span>
            <span class="app-float a5"><img src="img/logonet.png" alt=""></span>
            <span class="app-float a6"><img src="img/logocap.png" alt=""></span>
            <span class="app-float a7"><img src="img/logoam.png" alt=""></span>
            <span class="app-float a8"><img src="img/logonet.png" alt=""></span>
          </div>

          <h1>
            <span id="typeTarget"></span><span class="type-cursor" aria-hidden="true">|</span>
          </h1>

          <p class="sub">Pilih produk ‚Üí isi format ‚Üí lanjut pembayaran QRIS ‚Üí konfirmasi sudah bayar ‚Üí kirim ‚Üí WhatsApp admin.</p>
        </div>

        <aside class="showcase glass" aria-label="Highlight">
          <div class="badge">‚ú® Premium Picks</div>
          <div class="mini">
            <h3>Streaming & Hiburan</h3>
            <p>Netflix / YouTube Premium</p>
          </div>
          <div class="mini">
            <h3>Editing & Kreatif</h3>
            <p>CapCut / Alight Motion</p>
          </div>
          <div class="mini">
            <h3>Desain & Produktivitas</h3>
            <p>Canva / Spotify</p>
          </div>
        </aside>
      </div>
    </section>

    <!-- PRODUK -->
    <section id="produk">
      <div class="section-head">
        <div><h2>Produk Premium</h2></div>
        <a class="btn" href="#faq">Cara beli?</a>
      </div>
      <div id="productGrid" class="grid"></div>
    </section>

    <!-- SERVICE -->
    <section id="services">
      <div class="section-head">
        <div><h2>Service</h2></div>
        <a class="btn" href="#produk">Pilih Produk</a>
      </div>

      <div class="service-grid">
        <div class="card">
          <div style="font-weight:900;margin-bottom:6px;">‚öôÔ∏è Instalasi & Setup</div>
          <p>Bantuan instalasi, konfigurasi, dan optimasi agar siap dipakai.</p>
        </div>
        <div class="card">
          <div style="font-weight:900;margin-bottom:6px;">üîë Aktivasi</div>
          <p>Panduan aktivasi jelas dan cepat sesuai paket yang dibeli.</p>
        </div>
        <div class="card">
          <div style="font-weight:900;margin-bottom:6px;">üí¨ Support</div>
          <p>Bantuan chat untuk kendala umum sesuai jam layanan.</p>
        </div>
      </div>
    </section>

    <!-- FAQ -->
    <section id="faq">
      <div class="section-head">
        <div><h2>FAQ</h2></div>
        <a class="btn" href="#faq">Kembali ke atas</a>
      </div>

      <div class="faq-grid">
        <div class="faq-item glass">
          <button class="faq-btn" type="button">
            <span>Bagaimana cara membeli?</span>
            <span class="faq-ico">+</span>
          </button>
          <div class="faq-panel">
            Pilih produk ‚Üí klik <b>Beli Sekarang</b> ‚Üí isi format ‚Üí lanjut pembayaran QRIS ‚Üí
            pilih status bayar ‚Üí kirim ‚Üí WhatsApp admin.
          </div>
        </div>

        <div class="faq-item glass">
          <button class="faq-btn" type="button">
            <span>Kenapa produk tidak muncul?</span>
            <span class="faq-ico">+</span>
          </button>
          <div class="faq-panel">
            Coba hapus kata di search, scroll ke atas lalu ulangi.
            Pastikan nama produk kamu ketik sesuai (contoh: <b>Netflix</b>, <b>Canva</b>, dll).
          </div>
        </div>

        <div class="faq-item glass">
          <button class="faq-btn" type="button">
            <span>Search bisa cari apa saja?</span>
            <span class="faq-ico">+</span>
          </button>
          <div class="faq-panel">
            Bisa cari berdasarkan <b>nama</b>, <b>brand</b>, <b>tag</b>, atau <b>durasi</b>.
          </div>
        </div>

        <div class="faq-item glass">
          <button class="faq-btn" type="button">
            <span>Metode pembayaran apa saja?</span>
            <span class="faq-ico">+</span>
          </button>
          <div class="faq-panel">
            Pembayaran via <b>QRIS</b>. Wajib <b>tanya stok ke admin</b> dulu sebelum bayar.
          </div>
        </div>
      </div>
    </section>

    <!-- FOOTER -->
    <footer class="footer-wrap glass" id="footer">
      <div class="footer-top">
        <div class="f-brand">
          <div class="f-logo" aria-hidden="true">
            <img src="img/logo.png" alt="">
          </div>
          <div>
            <p class="f-title">Faxml Store</p>
            <p class="f-note">SECURED PAYMENT BY</p>
            <div style="margin-top:10px;">
              <img src="img/tripay.webp" alt="Tripay" style="height:34px;opacity:.95">
            </div>
          </div>
        </div>

        <div class="f-col">
          <h4>Products</h4>
          <div class="f-links">
            <a href="#services">Service</a>
            <a href="#produk">AI Tools</a>
          </div>
        </div>

        <div class="f-col">
          <h4>Profile</h4>
          <div class="f-links">
            <a href="#beranda">Tentang Kami</a>
            <a href="https://wa.me/6288221694607" target="_blank" rel="noopener">Kontak</a>
          </div>
        </div>

        <div class="f-col">
          <h4>Social Media</h4>
          <div class="f-social">
            <a href="https://www.instagram.com/faxmlstore?igsh=MWdtNmR4dnpqMTZ1bA%3D%3D&utm_source=qr" target="_blank" rel="noopener">
              <span class="ico"><img src="img/instagram.jpg" alt="Instagram"></span>
              <span class="txt">Instagram</span>
            </a>

            <a href="https://www.tiktok.com/@faxml_?_r=1&_t=ZS-93z3KJcEiUH" target="_blank" rel="noopener">
              <span class="ico"><img src="img/tiktok.jpg" alt="TikTok"></span>
              <span class="txt">TikTok</span>
            </a>
          </div>
        </div>
      </div>

      <div class="footer-line"></div>

      <div class="footer-bottom">
        <div>¬© Faxml Store.</div>
        <div class="footer-badges">
          <div class="f-badge"><span>üõ°Ô∏è</span> Secure Payment</div>
          <div class="f-badge"><span>üïò</span> 24/7 Support</div>
        </div>
      </div>
    </footer>

    <!-- Floating WA -->
    <a class="pk-chat" href="https://wa.me/6288221694607" target="_blank" rel="noopener" aria-label="Chat WhatsApp">
      <svg class="wa-ico" viewBox="0 0 448 512" aria-hidden="true">
        <path fill="currentColor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 222-99.6 222-222 0-59.3-25.2-115-67.1-156.9zM224 438.7c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3 18.6-68.2-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-82.8 184.6-184.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7 .9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.7z"/>
      </svg>
    </a>
  </main>

  <!-- BUY MODAL -->
  <div id="buyModal" class="modal-overlay" aria-hidden="true">
    <div class="modal glass" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal-header">
        <h3 id="modalTitle">Format Pembelian App Premium</h3>
        <button id="closeModal" class="modal-close" type="button" aria-label="Tutup">‚úï</button>
      </div>

      <form id="buyForm" class="modal-body">
        <div class="form-grid">
          <div class="field" style="grid-column:1/-1">
            <label>Produk</label>
            <input id="mPreview" type="text" disabled>
          </div>

          <div class="field">
            <label>tgl order <span class="req">*</span></label>
            <input id="f_tgl" type="date" required>
          </div>

          <div class="field">
            <label>durasi <span class="req">*</span></label>
            <input id="f_durasi" type="text" placeholder="Contoh: 1 Bulan" required>
          </div>

          <div id="block_netflix" style="display:none; grid-column:1/-1">
            <div class="form-grid">
              <div class="field">
                <label>merk hp <span class="req">*</span></label>
                <input id="n_merk" type="text" placeholder="Contoh: Samsung A54 / iPhone 13">
              </div>
              <div class="field">
                <label>lokasi <span class="req">*</span></label>
                <input id="n_lokasi" type="text" placeholder="Contoh: Kab/provinsi">
              </div>
              <div class="field" style="grid-column:1/-1">
                <label>1u/2u/semipriv/priv <span class="req">*</span></label>
                <select id="n_tipe">
                  <option value="">Pilih...</option>
                  <option value="1u">1u</option>
                  <option value="2u">2u</option>
                  <option value="semipriv">semipriv</option>
                  <option value="priv">priv</option>
                </select>
              </div>
            </div>
          </div>

          <div id="block_sharing" style="display:none; grid-column:1/-1">
            <div class="form-grid">
              <div class="field">
                <label>nama apk <span class="req">*</span></label>
                <input id="s_apk" type="text" placeholder="Contoh: CapCut / Netflix">
              </div>
              <div class="field">
                <label>device <span class="req">*</span></label>
                <select id="s_device">
                  <option value="">Pilih...</option>
                  <option value="Android">Android</option>
                  <option value="iPhone">iPhone</option>
                  <option value="PC/Laptop">PC/Laptop</option>
                  <option value="TV">TV</option>
                </select>
              </div>
              <div class="field">
                <label>lokasi <span class="req">*</span></label>
                <input id="s_lokasi" type="text" placeholder="Contoh: Indonesia / Kota">
              </div>
              <div class="field">
                <label>keterangan <span class="req">*</span></label>
                <input id="s_ket" type="text" placeholder="Contoh: request / catatan">
              </div>
            </div>
          </div>

          <div id="block_private" style="display:none; grid-column:1/-1">
            <div class="form-grid">
              <div class="field">
                <label>nama apk <span class="req">*</span></label>
                <input id="p_apk" type="text" placeholder="Contoh: Vidio / ChatGPT">
              </div>
              <div class="field" style="grid-column:1/-1">
                <label>keterangan <span class="req">*</span></label>
                <input id="p_ket" type="text" placeholder="Catatan / request">
              </div>
              <div class="field">
                <label>email</label>
                <input id="p_email" type="text" value="admin yang isi" disabled>
              </div>
              <div class="field">
                <label>password</label>
                <input id="p_pass" type="text" value="admin yang isi" disabled>
              </div>
            </div>
          </div>

          <div id="block_youtube" style="display:none; grid-column:1/-1">
            <div class="form-grid">
              <div class="field">
                <label>famplan/indplan <span class="req">*</span></label>
                <select id="y_plan">
                  <option value="">Pilih...</option>
                  <option value="famplan">famplan (need email saja)</option>
                  <option value="indplan">indplan (need email & pw)</option>
                </select>
              </div>
              <div class="field">
                <label>email <span class="req">*</span></label>
                <input id="y_email" type="email" placeholder="email@gmail.com">
              </div>
              <div class="field">
                <label>password (khusus indplan)</label>
                <input id="y_pass" type="text" placeholder="isi jika indplan">
              </div>
            </div>
          </div>

          <div id="block_canva" style="display:none; grid-column:1/-1">
            <div class="form-grid">
              <div class="field">
                <label>email <span class="req">*</span></label>
                <input id="c_email" type="email" placeholder="email@gmail.com">
              </div>
              <div class="field">
                <label>design/no <span class="req">*</span></label>
                <input id="c_design" type="text" placeholder="Contoh: design / no">
              </div>
            </div>
          </div>

          <div id="block_spotify" style="display:none; grid-column:1/-1">
            <div class="form-grid">
              <div class="field">
                <label>famplan/indplan <span class="req">*</span></label>
                <select id="sp_plan">
                  <option value="">Pilih...</option>
                  <option value="famplan">famplan</option>
                  <option value="indplan">indplan</option>
                </select>
              </div>
              <div class="field">
                <label>email <span class="req">*</span></label>
                <input id="sp_email" type="email" placeholder="email@gmail.com">
              </div>
              <div class="field">
                <label>password <span class="req">*</span></label>
                <input id="sp_pass" type="text" placeholder="password akun">
              </div>
            </div>
          </div>

          <div id="block_alight" style="display:none; grid-column:1/-1">
            <div class="form-grid">
              <div class="field">
                <label>durasi</label>
                <input id="a_durasi" type="text" value="1 tahun" disabled>
              </div>
              <div class="field">
                <label>password <span class="req">*</span></label>
                <input id="a_pass" type="text" placeholder="password akun">
              </div>
              <div class="field" style="grid-column:1/-1">
                <label>catatan (email wajib fresh no verif)</label>
                <input id="a_note" type="text" placeholder="tulis email fresh (no verif)">
              </div>
            </div>
          </div>

        </div>
      </form>

      <div class="modal-footer">
        <button type="button" class="btn" id="cancelModal">Batal</button>
        <button id="sendBtn" type="submit" class="btn primary" form="buyForm">Lanjut Pembayaran</button>
      </div>
    </div>
  </div>
<!-- LOADING VIEW (sebelum QRIS muncul) -->
<div id="loadingView" class="loading-view" aria-hidden="true">
  <div class="loading-card glass">
    <div class="loading-spinner" aria-hidden="true"></div>
    <p class="loading-title">Menyiapkan pembayaran‚Ä¶</p>
    <p class="loading-sub">Mohon tunggu sebentar</p>
  </div>
</div>

  <!-- PAYMENT MODAL (QRIS) -->
  <div id="payModal" class="modal-overlay" aria-hidden="true">
    <div class="modal glass" role="dialog" aria-modal="true" aria-labelledby="payTitle">
      <div class="modal-header">
        <h3 id="payTitle">Pembayaran QRIS</h3>
        <button id="closePay" class="modal-close" type="button">‚úï</button>
      </div>

      <div class="modal-body">
        <div id="paidNotif"
          style="display:none;margin-bottom:12px;padding:10px 12px;border-radius:12px;
          background:rgba(34,197,94,.15);border:1px solid rgba(34,197,94,.35);
          color:rgba(255,255,255,.92);font-weight:900;font-size:13px;">
          üîî Pembayaran Berhasil (Klik <b>Lanjut WhatsApp</b>)
        </div>

        <div style="display:flex;flex-direction:column;gap:12px;">
          <div style="font-weight:900">Silakan bayar sesuai nominal:</div>
          <div id="payAmount" style="font-size:22px;font-weight:900;"></div>

          <div style="border:1px solid rgba(255,255,255,.14);border-radius:14px;padding:12px;background:rgba(255,255,255,.04);">
            <div style="font-weight:900; margin-bottom:6px;">‚ö†Ô∏è QRIS NOTE</div>
            <div style="color:rgba(255,255,255,.78);font-weight:800;font-size:13px;line-height:1.6;">
              ‚Ä¢ <b>Tanyakan stok ke admin dulu</b> sebelum melakukan pembayaran.<br>
              ‚Ä¢ Setelah admin konfirmasi stok, baru lanjut bayar via QRIS.<br>
              ‚Ä¢ Setelah bayar, pilih <b>Sudah</b> lalu klik <b>Kirim</b>.
            </div>
          </div>

          <div style="border:1px solid rgba(255,255,255,.12);border-radius:16px;padding:12px;background:rgba(255,255,255,.04);">
            <img id="qrisImg" alt="QRIS"
              style="width:100%;max-width:340px;display:block;margin:0 auto;border-radius:12px;">
            <div style="margin-top:10px;color:rgba(255,255,255,.75);font-weight:800;font-size:13px;line-height:1.6;">
              Scan QRIS ‚Üí pilih status bayar ‚Üí klik <b>‚ÄúKirim‚Äù</b> untuk konfirmasi (notif muncul) ‚Üí klik <b>‚ÄúLanjut WhatsApp‚Äù</b>.
            </div>

            <div style="margin-top:10px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap;">
              <a id="qrisHref" class="btn" href="#" target="_blank" rel="noopener">Buka QRIS</a>
              <button id="askStockBtn" type="button" class="btn">Tanya stok</button>
            </div>
          </div>

          <div class="field">
            <label>Apakah sudah bayar? <span class="req">*</span></label>
            <div class="radio-row">
              <div class="radio-item">
                <input type="radio" id="paid_yes" name="paid" value="yes">
                <label for="paid_yes">Sudah</label>
              </div>
              <div class="radio-item">
                <input type="radio" id="paid_no" name="paid" value="no" checked>
                <label for="paid_no">Belum</label>
              </div>
            </div>

            <small style="display:block;margin-top:8px;color:rgba(255,255,255,.70);font-weight:800;line-height:1.5;">
              Pilih <b>Sudah</b> jika kamu sudah scan QRIS, lalu klik <b>Kirim</b>.
            </small>
          </div>

        </div>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn" id="backToForm">Kembali</button>
        <button type="button" class="btn primary" id="sendPaid" disabled>Kirim</button>
      </div>
    </div>
  </div>

  <!-- QRIS OVERLAY -->
  <div id="qrisView" class="qris-view" aria-hidden="true">
    <div class="qris-box glass" role="dialog" aria-modal="true" aria-label="QRIS">
      <button id="closeQrisBtn" class="qris-x" type="button" aria-label="Tutup QRIS">√ó</button>
      <img id="qrisBigImg" class="qris-img-big" alt="QRIS Besar">
    </div>
  </div>

<script>
/* ========= helpers ========= */
const qs = (q) => document.querySelector(q);
const normalize = (str) => (str ?? "").toString().toLowerCase().trim();
const requireVal = (v) => (v || "").toString().trim();

const WA_NUMBER = "6288221694607";
const waLink = (text) => `https://wa.me/${WA_NUMBER}?text=${encodeURIComponent(text)}`;
const QRIS_IMAGE_URL = "img/qris.jpeg";

const formatRupiah = (n) => {
  const num = Number(n) || 0;
  return "Rp" + num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
};
const todayISO = () => {
  const d = new Date();
  const mm = String(d.getMonth()+1).padStart(2,"0");
  const dd = String(d.getDate()).padStart(2,"0");
  return `${d.getFullYear()}-${mm}-${dd}`;
};

/* ========= iOS/Android SCROLL LOCK (no jitter) =========
   pakai position:fixed biar gak ‚Äúloncat‚Äù / ‚Äúgeser sendiri‚Äù */
let __lockY = 0;
function lockScroll(){
  __lockY = window.scrollY || window.pageYOffset || 0;
  document.body.style.position = "fixed";
  document.body.style.top = `-${__lockY}px`;
  document.body.style.left = "0";
  document.body.style.right = "0";
  document.body.style.width = "100%";
}
function unlockScroll(){
  document.body.style.position = "";
  document.body.style.top = "";
  document.body.style.left = "";
  document.body.style.right = "";
  document.body.style.width = "";
  window.scrollTo(0, __lockY);
}

/* ========= typing effect (LOOP: ketik berulang) ========= */
(function typingLoop(){
  const el = document.querySelector("#typeTarget");
  if(!el) return;

  const prefersReduce = window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches;

  const text = "Jual Aplikasi Premium, Aman, dan Tepercaya.";
  const typeSpeed = 55;        // kecepatan ngetik
  const deleteSpeed = 35;      // kecepatan hapus
  const holdAfterType = 1200;  // jeda setelah selesai ngetik
  const holdAfterDelete = 350; // jeda setelah selesai hapus

  if (prefersReduce){
    el.textContent = text;
    return;
  }

  let i = 0;
  let deleting = false;

  function tick(){
    if (!deleting){
      i++;
      el.textContent = text.slice(0, i);
      if (i >= text.length){
        deleting = true;
        setTimeout(tick, holdAfterType);
      } else {
        setTimeout(tick, typeSpeed);
      }
    } else {
      i--;
      el.textContent = text.slice(0, i);
      if (i <= 0){
        deleting = false;
        setTimeout(tick, holdAfterDelete);
      } else {
        setTimeout(tick, deleteSpeed);
      }
    }
  }

  tick();
})();


/* ========= FX overlay ========= */
(() => {
  const rand = (a,b)=>Math.random()*(b-a)+a;

  function build(wrap){
    const isMobile = (innerWidth||360) <= 720;
    const count = isMobile ? 16 : 22; // lebih ringan di mobile
    const colors = ["rgba(117,83,255,.35)","rgba(0,210,255,.28)","rgba(0,255,200,.22)","rgba(255,255,255,.18)"];
    for(let i=0;i<count;i++){
      const p=document.createElement("span"); p.className="fx-p";
      p.style.setProperty("--s",(isMobile?rand(7,16):rand(8,20))+"px");
      p.style.setProperty("--b",rand(0,2.0)+"px");
      p.style.setProperty("--x",rand(2,98).toFixed(2)+"%");
      p.style.setProperty("--y",rand(2,98).toFixed(2)+"%");
      p.style.setProperty("--dx",rand(-16,16).toFixed(0)+"px");
      p.style.setProperty("--dy",(-rand(40,isMobile?85:75)).toFixed(0)+"px");
      p.style.setProperty("--d",rand(isMobile?7:8, isMobile?12:13).toFixed(2)+"s");
      p.style.setProperty("--o",rand(0.18,isMobile?0.40:0.34).toFixed(2));
      p.style.setProperty("--c",colors[Math.floor(rand(0,colors.length))]);
      p.style.animationDelay = rand(-10,0).toFixed(2)+"s";
      wrap.appendChild(p);
    }
  }

  function mount(){
    if(document.querySelector(".fx-overlay")) return;
    const o=document.createElement("div"); o.className="fx-overlay";
    const s=document.createElement("div"); s.className="fx-shimmer";
    const p=document.createElement("div"); p.className="fx-particles";
    o.appendChild(s); o.appendChild(p);
    document.body.prepend(o);
    build(p);
  }

  addEventListener("DOMContentLoaded", mount, { passive:true });
})();

/* ========= FAQ accordion ========= */
document.addEventListener("click", (e) => {
  const btn = e.target.closest(".faq-btn");
  if (!btn) return;
  const item = btn.closest(".faq-item");
  const ico = btn.querySelector(".faq-ico");
  const isOpen = item.classList.toggle("open");
  if (ico) ico.textContent = isOpen ? "‚àí" : "+";
}, { passive:true });

/* ========= Sidebar Mobile ========= */
const hamburger  = qs("#hamburger");
const mobileMenu = qs("#mobileMenu");
const menuOverlay= qs("#menuOverlay");
const mobileClose= qs("#mobileClose");

function openMenu(){
  if (!mobileMenu || !menuOverlay || !hamburger) return;
  mobileMenu.classList.add("open");
  menuOverlay.classList.add("show");
  hamburger.setAttribute("aria-expanded", "true");
  lockScroll();
}
function closeMenu(){
  if (!mobileMenu || !menuOverlay || !hamburger) return;
  mobileMenu.classList.remove("open");
  menuOverlay.classList.remove("show");
  hamburger.setAttribute("aria-expanded", "false");
  // unlock hanya kalau tidak ada modal lain
  if (!qs("#buyModal")?.classList.contains("show") && !qs("#payModal")?.classList.contains("show") && !qs("#qrisView")?.classList.contains("show")) {
    unlockScroll();
  }
}

hamburger?.addEventListener("click", () => {
  mobileMenu.classList.contains("open") ? closeMenu() : openMenu();
});
menuOverlay?.addEventListener("click", closeMenu);
mobileClose?.addEventListener("click", closeMenu);
mobileMenu?.querySelectorAll('a[href^="#"]').forEach(a => a.addEventListener("click", closeMenu));

/* ========= Smooth scroll with offset (tanpa loncat) ========= */
(() => {
  const prefersReduce = window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches;

function navOffset(){
  const nav = document.getElementById("topNav");
  if (!nav) return 170;
  // r.bottom sudah termasuk posisi sticky top + safe area, jadi offset lebih akurat di iPhone
  const r = nav.getBoundingClientRect();
  return Math.round(r.bottom + 12);
}

  function smoothTo(el){
    const y = window.pageYOffset + el.getBoundingClientRect().top - navOffset();
    if (prefersReduce) return window.scrollTo(0, y);
    window.scrollTo({ top: y, behavior: "smooth" });
  }

  document.addEventListener("click", (e) => {
    const a = e.target.closest('a[href^="#"]');
    if (!a) return;

    const id = a.getAttribute("href");
    if (!id || id === "#") return;

    const target = document.querySelector(id);
    if (!target) return;

    e.preventDefault();

    if (mobileMenu?.classList.contains("open")){
      closeMenu();
      setTimeout(() => smoothTo(target), 80);
    }else{
      smoothTo(target);
    }

    history.replaceState(null, "", id);
  }, { passive:false });
})();

/* ========= ESC close ========= */
document.addEventListener("keydown", (e) => {
  if (e.key !== "Escape") return;
  closeMenu();
  closeBuyModal();
  closePayModal();
  closeQrisView();
});

/* ========= DATA PRODUK ========= */
const products = [
  { brand:"netflix", label:"NETFLIX", name:"Netflix Premium 1 User", duration:"1 Bulan", price:35000, stock:10, tag:"Best Seller", img:"img/netflix.png" },
  { brand:"netflix", label:"NETFLIX", name:"Netflix Premium 2 User", duration:"1 Bulan", price:27000, stock:10, tag:"Best Seller", img:"img/netflix.png" },
  { brand:"netflix", label:"NETFLIX", name:"Netflix Premium SemiPrivate", duration:"1 Bulan", price:39000, stock:10, tag:"Best Seller", img:"img/netflix.png" },

  { brand:"capcut",  label:"CAPCUT",  name:"CapCut Premium Sharing 3 User", duration:"1 Bulan", price:10000, stock:20, tag:"Team", img:"img/capcut.jpg" },
  { brand:"capcut",  label:"CAPCUT",  name:"CapCut Premium Sharing 8 User", duration:"1 Bulan", price:5000,  stock:20, tag:"Team", img:"img/capcut.jpg" },
  { brand:"capcut",  label:"CAPCUT",  name:"CapCut Premium Sharing 5 User", duration:"1 Bulan", price:7000,  stock:20, tag:"Team", img:"img/capcut.jpg" },

  { brand:"capcut",  label:"CAPCUT",  name:"CapCut Premium Private Garansi 7 Hari", duration:"7 Hari", price:12000, stock:20, tag:"Original", img:"img/capcut.jpg" },
  { brand:"capcut",  label:"CAPCUT",  name:"CapCut Premium Private Garansi 14 Hari", duration:"14 Hari", price:15000, stock:20, tag:"Original", img:"img/capcut.jpg" },
  { brand:"capcut",  label:"CAPCUT",  name:"CapCut Premium Private Garansi 28 Hari", duration:"28 Hari", price:20000, stock:20, tag:"Original", img:"img/capcut.jpg" },
  { brand:"capcut",  label:"CAPCUT",  name:"CapCut Premium Private Garansi Full", duration:"35 Hari", price:23000, stock:20, tag:"Original", img:"img/capcut.jpg" },

  { brand:"chatgpt", label:"CHATGPT", name:"ChatGPT Premium Private", duration:"1 Bulan", price:18000, stock:20, tag:"Populer", img:"img/chatgpt.png" },
  { brand:"gemini",  label:"GEMINI",  name:"GEMINI PRO + GDRIVE 2TB + Veo3", duration:"1 Bulan", price:10000, stock:20, tag:"Populer", img:"img/gemini.png" },

  { brand:"canva",   label:"CANVA",   name:"Canva Premium Team", duration:"1 Bulan", price:6000,  stock:50, tag:"Team", img:"img/canva.png" },
  { brand:"canva",   label:"CANVA",   name:"Canva Premium Team (Plus)", duration:"1 Bulan", price:15000, stock:20, tag:"Team", img:"img/canva.png" },

  { brand:"spotify", label:"SPOTIFY", name:"Spotify Premium Famplan", duration:"1 Bulan", price:26000, stock:10, tag:"Ready", img:"img/spotify.png" },
  { brand:"spotify", label:"SPOTIFY", name:"Spotify Premium Indplan", duration:"1 Bulan", price:28000, stock:10, tag:"Ready", img:"img/spotify.png" },

  { brand:"youtube", label:"YOUTUBE", name:"YouTube Premium Famplan", duration:"1 Bulan", price:5000, stock:10, tag:"Team", img:"img/youtube.png" },
  { brand:"youtube", label:"YOUTUBE", name:"YouTube Premium Indplan", duration:"1 Bulan", price:15000, stock:10, tag:"Populer", img:"img/youtube.png" },

  { brand:"alight",  label:"ALIGHT",  name:"Alight Motion Private", duration:"1 Tahun", price:10000, stock:100, tag:"Populer", img:"img/alightmotion.png" },
  { brand:"Tutor AM", label:"Tutor AM", name:"Tutor Alight Motion", duration:"Seumurhidup", price:80000, stock:100, tag:"Populer", img:"img/tutoram.png" },

  { brand:"wink",  label:"WINK", name:"Wink Premium Private Android", duration:"7 Hari", price:10000, stock:10, tag:"Populer", img:"img/wink.png" },
  { brand:"viu",  label:"VIU", name:"Viu Premium Private", duration:"3 Bulan", price:13000, stock:20, tag:"Original", img:"img/viu.png" },
  { brand:"viu",  label:"VIU", name:"Viu Premium Private", duration:"Lifetime", price:20000, stock:20, tag:"Populer", img:"img/viu.png" },

  { brand:"bstation", label:"B-STATION", name:"Bstation Premium Sharing", duration:"1 Bulan", price:13000, stock:20, tag:"Populer", img:"img/bstation.png" },
  { brand:"wetv", label:"WETV", name:"Wetv Premium Sharing 8 User", duration:"1 Bulan", price:10000, stock:20, tag:"Original", img:"img/wetv.png" },

  { brand:"vidio", label:"VIDIO", name:"Vidio Premium Sharing 2 User", duration:"1 Bulan", price:25000, stock:20, tag:"Original", img:"img/vidio.png" },
  { brand:"vidio", label:"VIDIO", name:"Vidio Premium Sharing 2u Onlyhp", duration:"1 Bulan", price:20000, stock:20, tag:"Original", img:"img/vidio.png" },
  { brand:"vidio", label:"VIDIO", name:"Vidio Premium Private Alldev", duration:"1 Bulan", price:36000, stock:20, tag:"Original", img:"img/vidio.png" },
  { brand:"vidio", label:"VIDIO", name:"Vidio Premium Private Onlyhp", duration:"1 Bulan", price:28000, stock:20, tag:"Original", img:"img/vidio.png" },
  { brand:"vidio", label:"VIDIO", name:"Vidio OnlyTV", duration:"1 Tahun", price:13000, stock:20, tag:"Original", img:"img/vidio.png" },

  { brand:"hbomax", label:"HBO MAX", name:"HBO MAX Sharing", duration:"1 Bulan", price:19000, stock:20, tag:"Original", img:"img/hbomax.png" },

  { brand:"iqiyi", label:"IQIYI", name:"Iqiyi Sharing Standar", duration:"1 Bulan", price:12000, stock:20, tag:"Original", img:"img/iqiyi.png" },
  { brand:"iqiyi", label:"IQIYI", name:"Iqiyi Sharing Prem", duration:"1 Bulan", price:15000, stock:20, tag:"Original", img:"img/iqiyi.png" },

  { brand:"prime video", label:"PRIME VIDEO", name:"Prime Video Sharing", duration:"1 Bulan", price:12000, stock:20, tag:"Original", img:"img/primevideo.png" },
  { brand:"prime video", label:"PRIME VIDEO", name:"Prime Video Private", duration:"1 Bulan", price:18000, stock:20, tag:"Original", img:"img/primevideo.png" },

  { brand:"lightroom", label:"LIGHTROOM", name:"Lightroom Premium Sharing", duration:"1 Tahun", price:20000, stock:20, tag:"Original", img:"img/lightroom.png" },
  { brand:"picsart", label:"PICSART", name:"Picsart Premium Private", duration:"1 Bulan", price:14000, stock:20, tag:"Original", img:"img/picsart.png" },
];

function renderProducts(list) {
  const productGrid = qs("#productGrid");
  if (!productGrid) return;

  productGrid.innerHTML = list.map((p) => {
    const ready = (Number(p.stock) || 0) > 0;
    return `
      <article class="card">
        <div class="product-thumb">
          <img src="${p.img}" alt="${p.name}" loading="lazy" decoding="async" onerror="this.style.display='none'">
          <span class="stock-badge ${ready ? "" : "habis"}">${ready ? `Ready ‚Ä¢ ${p.stock}` : "Habis"}</span>
          <div class="thumb-brand">${(p.label || p.brand || "")}</div>
        </div>

        <div class="product-top">
          <span class="tag">${p.tag}</span>
          <span class="product-sub">${p.duration}</span>
        </div>

        <h3>${p.name}</h3>
        <p>Akses premium sesuai paket. Support tersedia untuk proses pembelian & kendala umum.</p>

        <div class="price-row">
          <div>
            <span class="price">${formatRupiah(p.price)}</span>
            <span class="tiny">/${p.duration}</span>
          </div>
          <a class="btn" href="#faq">Detail</a>
        </div>

        ${
          ready
            ? `<button class="btn btn-buy primaryish" type="button"
                data-buy
                data-product="${p.name}"
                data-brand="${p.brand}"
                data-price="${p.price}"
                data-duration="${p.duration}"
              >Beli Sekarang</button>`
            : `<button class="btn btn-buy out" disabled>Stok Habis</button>`
        }
      </article>
    `;
  }).join("");
}

/* ========= Search ========= */
const searchInput = qs("#searchInput");
const searchClear = qs("#searchClear");

function applySearch(q) {
  const query = normalize(q);
  const filtered = !query ? products : products.filter((p) => {
    const hay = [p.name, p.label, p.brand, p.tag, p.duration].map(normalize).join(" ");
    return hay.includes(query);
  });
  renderProducts(filtered);
}
function setSearchValue(val) {
  if (!searchInput) return;
  searchInput.value = val;
  searchInput.parentElement?.classList.toggle("has-value", normalize(val).length > 0);
  applySearch(val);
}
searchInput?.addEventListener("input", (e) => setSearchValue(e.target.value), { passive:true });
searchClear?.addEventListener("click", () => setSearchValue(""), { passive:true });

/* ========= BUY modal ========= */
const buyModal = qs("#buyModal");
const closeModal = qs("#closeModal");
const cancelModal = qs("#cancelModal");
const buyForm = qs("#buyForm");
const mPreview = qs("#mPreview");
const f_tgl = qs("#f_tgl");
const f_durasi = qs("#f_durasi");

const blocks = ["netflix","sharing","private","youtube","canva","spotify","alight"];
function showBlock(type){
  blocks.forEach((k) => {
    const el = qs("#block_" + k);
    if (!el) return;
    const isActive = (k === type);
    el.style.display = isActive ? "block" : "none";
    el.querySelectorAll("input, select, textarea, button").forEach((inp) => {
      inp.disabled = !isActive;
    });
  });
}

function detectType(productName, brand) {
  const n = normalize(productName);
  const b = normalize(brand);
  if (b.includes("netflix") || n.includes("netflix")) return "netflix";
  if (b.includes("youtube") || n.includes("youtube")) return "youtube";
  if (b.includes("canva") || n.includes("canva")) return "canva";
  if (b.includes("spotify") || n.includes("spotify")) return "spotify";
  if (b.includes("alight") || n.includes("alight")) return "alight";
  if (n.includes("private")) return "private";
  return "sharing";
}

let selectedOrder = { product:"", brand:"", price:0, duration:"", type:"" };
let waFinalMessage = "";

function openBuyModal({ product, brand, price, duration }) {
  const type = detectType(product, brand);
  selectedOrder = {
    product: product || "",
    brand: brand || "",
    price: Number(price) || 0,
    duration: duration || "",
    type
  };

  if (mPreview) mPreview.value = `${selectedOrder.product} ‚Ä¢ ${selectedOrder.duration} ‚Ä¢ ${formatRupiah(selectedOrder.price)}`;
  if (f_tgl) f_tgl.value = todayISO();
  if (f_durasi) f_durasi.value = selectedOrder.duration || "";

  const s_apk = qs("#s_apk"); if (s_apk) s_apk.value = selectedOrder.product;
  const p_apk = qs("#p_apk"); if (p_apk) p_apk.value = selectedOrder.product;

  showBlock(type);

  buyModal.classList.add("show");
  buyModal.setAttribute("aria-hidden", "false");
  lockScroll();
}

function closeBuyModal() {
  if (!buyModal?.classList.contains("show")) return;
  buyModal.classList.remove("show");
  buyModal.setAttribute("aria-hidden", "true");
  buyForm?.reset();
  selectedOrder = { product:"", brand:"", price:0, duration:"", type:"" };
  waFinalMessage = "";

  if (!qs("#payModal")?.classList.contains("show") && !qs("#qrisView")?.classList.contains("show") && !mobileMenu?.classList.contains("open")) {
    unlockScroll();
  }
}

document.addEventListener("click", (e) => {
  const btn = e.target.closest("[data-buy]");
  if (!btn) return;
  openBuyModal({
    product: btn.getAttribute("data-product"),
    brand: btn.getAttribute("data-brand"),
    price: btn.getAttribute("data-price"),
    duration: btn.getAttribute("data-duration"),
  });
});

closeModal?.addEventListener("click", closeBuyModal, { passive:true });
cancelModal?.addEventListener("click", closeBuyModal, { passive:true });
buyModal?.addEventListener("click", (e) => { if (e.target === buyModal) closeBuyModal(); }, { passive:true });

/* ========= PAYMENT modal ========= */
const payModal = qs("#payModal");
const closePay = qs("#closePay");
const backToForm = qs("#backToForm");
const sendPaid = qs("#sendPaid");
const payAmount = qs("#payAmount");
const qrisImg = qs("#qrisImg");
const qrisHref = qs("#qrisHref");
const askStockBtn = qs("#askStockBtn");
const paidNotif = qs("#paidNotif");
const paidYes = qs("#paid_yes");
const paidNo  = qs("#paid_no");

let waReadyToOpen = false;

function resetPayUI(){
  waReadyToOpen = false;
  if (paidNotif) paidNotif.style.display = "none";
  if (sendPaid){
    sendPaid.textContent = "Kirim";
    sendPaid.disabled = !(paidYes?.checked === true);
  }
}
function syncSendPaidState(){
  const isPaid = (paidYes?.checked === true);
  if (!waReadyToOpen && sendPaid) sendPaid.disabled = !isPaid;

  if (!isPaid){
    waReadyToOpen = false;
    if (paidNotif) paidNotif.style.display = "none";
    if (sendPaid){
      sendPaid.textContent = "Kirim";
      sendPaid.disabled = true;
    }
  }
}
paidYes?.addEventListener("change", syncSendPaidState, { passive:true });
paidNo?.addEventListener("change", syncSendPaidState, { passive:true });

function openPayModal(){
  if (payAmount) payAmount.textContent = formatRupiah(selectedOrder.price);
  if (qrisImg) qrisImg.src = QRIS_IMAGE_URL;
  if (qrisHref) qrisHref.href = QRIS_IMAGE_URL;

  if (paidNo) paidNo.checked = true;
  resetPayUI();
  syncSendPaidState();

  payModal.classList.add("show");
  payModal.setAttribute("aria-hidden", "false");
  lockScroll();
}
function closePayModal(){
  if (!payModal?.classList.contains("show")) return;
  payModal.classList.remove("show");
  payModal.setAttribute("aria-hidden", "true");
  if (paidNo) paidNo.checked = true;
  resetPayUI();
  syncSendPaidState();

  if (!qs("#buyModal")?.classList.contains("show") && !qs("#qrisView")?.classList.contains("show") && !mobileMenu?.classList.contains("open")) {
    unlockScroll();
  }
}

closePay?.addEventListener("click", closePayModal, { passive:true });
payModal?.addEventListener("click", (e) => { if (e.target === payModal) closePayModal(); }, { passive:true });

backToForm?.addEventListener("click", () => {
  closePayModal();
  buyModal.classList.add("show");
  buyModal.setAttribute("aria-hidden", "false");
  lockScroll();
}, { passive:true });

askStockBtn?.addEventListener("click", () => {
  if (!selectedOrder.product) return alert("Pilih produk dulu.");
  const msg =
`Halo admin, saya mau tanya stok dulu ya ‚úÖ

Produk: ${selectedOrder.product}
Durasi: ${selectedOrder.duration}
Harga: ${formatRupiah(selectedOrder.price)}

Apakah stok ready?`;
  window.open(waLink(msg), "_blank", "noopener,noreferrer");
}, { passive:true });

sendPaid?.addEventListener("click", () => {
  if (!waFinalMessage) return alert("Data order belum ada. Isi format dulu.");
  const isPaid = (paidYes?.checked === true);
  if (!isPaid) return;

  if (!waReadyToOpen){
    if (paidNotif) paidNotif.style.display = "block";
    const body = payModal?.querySelector(".modal-body");
    if (body) body.scrollTo({ top: 0, behavior: "smooth" });

    waReadyToOpen = true;
    sendPaid.textContent = "Lanjut WhatsApp";
    sendPaid.disabled = false;
    return;
  }

  const finalMsg =
`${waFinalMessage}

üîî *Konfirmasi pembayaran:* SUDAH BAYAR
‚è≥ Status: Menunggu admin proses.`.trim();

  window.open(waLink(finalMsg), "_blank", "noopener,noreferrer");
  closePayModal();
  closeBuyModal();
}, { passive:true });

/* ========= BUY FORM submit ========= */
buyForm?.addEventListener("submit", (e) => {
  e.preventDefault();

  const type = selectedOrder.type || "sharing";
  const tgl = requireVal(f_tgl.value);
  const durasi = requireVal(f_durasi.value);
  if (!tgl || !durasi) return alert("Harap isi tgl order & durasi (*)");

  const hargaTxt = formatRupiah(selectedOrder.price);
  const basePayNote =
`‚ö†Ô∏è Sebelum bayar: *tanyakan stok ke admin dulu!*
Metode pembayaran: *QRIS*
Nominal: *${hargaTxt}*`;

  let msg = "";

  if (type === "netflix") {
    const merk = requireVal(qs("#n_merk")?.value);
    const lokasi = requireVal(qs("#n_lokasi")?.value);
    const tipe = requireVal(qs("#n_tipe")?.value);
    if (!merk || !lokasi || !tipe) return alert("Harap isi semua field wajib (*)");
    msg =
`*Format Netflix*

*üê£* produk : ${selectedOrder.product}
*üê£* tgl order : ${tgl}
*üê£* durasi : ${durasi}
*üê£* harga : ${hargaTxt}
*üê£* merk hp : ${merk}
*üê£* lokasi : ${lokasi}
*üê£* 1u/2u/semipriv/priv : ${tipe}

${basePayNote}`;
  } else if (type === "youtube") {
    const plan = requireVal(qs("#y_plan")?.value);
    const email = requireVal(qs("#y_email")?.value);
    const pass = requireVal(qs("#y_pass")?.value);
    if (!plan || !email) return alert("Harap isi semua field wajib (*)");
    if (plan === "indplan" && !pass) return alert("Indplan wajib isi password");
    msg =
`‚Ä¢‚îà  *format youtube* ‚îà‚Ä¢

*îòì* produk : ${selectedOrder.product}
*îòì* tgl order : ${tgl}
*îòì* durasi : ${durasi}
*îòì* harga : ${hargaTxt}
*îòì* email : ${email}
*îòì* password : ${pass || "-"}
*îòì* famplan/indplan : ${plan}

${basePayNote}`;
  } else if (type === "canva") {
    const email = requireVal(qs("#c_email")?.value);
    const design = requireVal(qs("#c_design")?.value);
    if (!email || !design) return alert("Harap isi semua field wajib (*)");
    msg =
`‚Ä¢‚îà  *format canva* ‚îà‚Ä¢

*îòì* produk : ${selectedOrder.product}
*îòì* tgl order : ${tgl}
*îòì* durasi : ${durasi}
*îòì* harga : ${hargaTxt}
*îòì* email : ${email}
*îòì* design/no : ${design}

${basePayNote}`;
  } else if (type === "spotify") {
    const plan = requireVal(qs("#sp_plan")?.value);
    const email = requireVal(qs("#sp_email")?.value);
    const pass = requireVal(qs("#sp_pass")?.value);
    if (!plan || !email || !pass) return alert("Harap isi semua field wajib (*)");
    msg =
`‚Ä¢‚îà  *format spotify* ‚îà‚Ä¢

*îòì* produk : ${selectedOrder.product}
*îòì* tgl order : ${tgl}
*îòì* durasi : ${durasi}
*îòì* harga : ${hargaTxt}
*îòì* email : ${email}
*îòì* password: ${pass}
*îòì* famplan/indplan : ${plan}

${basePayNote}`;
  } else if (type === "alight") {
    const pass = requireVal(qs("#a_pass")?.value);
    const note = requireVal(qs("#a_note")?.value);
    if (!pass) return alert("Harap isi password (*)");
    msg =
`‚Ä¢‚îà  *format alightmotion* ‚îà‚Ä¢

*îòì* produk : ${selectedOrder.product}
*îòì* tgl order : ${tgl}
*îòì* durasi : 1 tahun
*îòì* harga : ${hargaTxt}
*îòì* password : ${pass}

‚Ä¢ email wajib fresh no verif
${note ? "‚Ä¢ catatan : " + note : ""}

${basePayNote}`.trim();
  } else if (type === "private") {
    const apk = requireVal(qs("#p_apk")?.value);
    const ket = requireVal(qs("#p_ket")?.value);
    if (!apk || !ket) return alert("Harap isi semua field wajib (*)");
    msg =
`‚Ä¢‚îà *format app private*‚îà‚Ä¢

*îòì* produk : ${selectedOrder.product}
*îòì* tgl order : ${tgl}
*îòì* nama apk : ${apk}
*îòì* durasi : ${durasi}
*îòì* harga : ${hargaTxt}
*îòì* email : admin yang isi
*îòì* password : admin yang isi
*îòì* keterangan : ${ket}

${basePayNote}`;
  } else {
    const apk = requireVal(qs("#s_apk")?.value);
    const device = requireVal(qs("#s_device")?.value);
    const lokasi = requireVal(qs("#s_lokasi")?.value);
    const ket = requireVal(qs("#s_ket")?.value);
    if (!apk || !device || !lokasi || !ket) return alert("Harap isi semua field wajib (*)");
    msg =
`‚Ä¢‚îà  *format app sharing* ‚îà‚Ä¢

*îòì* produk : ${selectedOrder.product}
*îòì* tgl order : ${tgl}
*îòì* nama apk : ${apk}
*îòì* durasi : ${durasi}
*îòì* harga : ${hargaTxt}
*îòì* device : ${device}
*îòì* lokasi : ${lokasi}
*îòì* keterangan : ${ket}

${basePayNote}`;
  }

  waFinalMessage = msg;

  buyModal.classList.remove("show");
  buyModal.setAttribute("aria-hidden", "true");
  openPayModal();
}, { passive:false });

/* ===== FINAL PATCH: tombol loading + overlay loading sebelum QRIS ===== */
(() => {
  if (window.__FAXML_LOADING_PATCH__) return;
  window.__FAXML_LOADING_PATCH__ = true;

  const loadingView = document.getElementById("loadingView");
  const sendBtn = document.getElementById("sendBtn");     // tombol "Lanjut Pembayaran"
  const buyForm = document.getElementById("buyForm");
  const buyModalEl = document.getElementById("buyModal");
  if (!loadingView || !sendBtn || !buyForm || !buyModalEl) return;

  const prefersReduce = window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches;
  const LOADING_SECONDS = 2; // durasi loading (detik)
  const LOADING_DELAY   = prefersReduce ? 0 : Math.round(LOADING_SECONDS * 1000);


  let token = 0;
  let btnOldHTML = "";
  let btnOldDisabled = false;

  const showOverlay = () => {
    loadingView.classList.add("show");
    loadingView.setAttribute("aria-hidden", "false");
  };
  const hideOverlay = () => {
    loadingView.classList.remove("show");
    loadingView.setAttribute("aria-hidden", "true");
  };

  const setBtnLoading = (on) => {
    if (!sendBtn) return;
    if (on) {
      // simpan state awal
      if (!btnOldHTML) btnOldHTML = sendBtn.innerHTML;
      btnOldDisabled = sendBtn.disabled;

      sendBtn.disabled = true;
      sendBtn.classList.add("is-loading");
      sendBtn.innerHTML = `<span class="btn-spin" aria-hidden="true"></span><span>Memproses‚Ä¶</span>`;
    } else {
      // restore
      if (btnOldHTML) sendBtn.innerHTML = btnOldHTML;
      sendBtn.disabled = btnOldDisabled;
      sendBtn.classList.remove("is-loading");

      // reset cache supaya aman kalau HTML berubah dari luar
      btnOldHTML = "";
      btnOldDisabled = false;
    }
  };

  // Saat submit (klik "Lanjut Pembayaran"), tampilkan loading di tombol.
  // Kalau validasi gagal (modal tetap terbuka), auto balik normal.
  buyForm.addEventListener("submit", () => {
    const my = ++token;
    setBtnLoading(true);

    // tunggu sebentar: kalau buyModal masih "show", berarti handler lama return karena alert/validasi
    setTimeout(() => {
      if (my !== token) return;
      const stillOpen = buyModalEl.classList.contains("show");
      if (stillOpen) {
        setBtnLoading(false);
        hideOverlay();
      }
    }, 220);
  }, true);

  // Patch openPayModal: overlay loading dulu, baru QRIS.
  if (typeof window.openPayModal === "function") {
    const _openPayModal = window.openPayModal;

    window.openPayModal = function () {
      const my = ++token;

      // overlay tampil setelah buy modal ketutup (biar tombol sempat kelihatan)
      setTimeout(() => {
        if (my !== token) return;
        showOverlay();
      }, prefersReduce ? 0 : 120);

      setTimeout(() => {
        if (my !== token) return;
        hideOverlay();
        setBtnLoading(false);
        _openPayModal();
      }, LOADING_DELAY);
    };
  }

  // Safety: kalau pay modal ditutup, pastikan overlay/tombol normal lagi
  if (typeof window.closePayModal === "function") {
    const _closePayModal = window.closePayModal;
    window.closePayModal = function () {
      token++;
      hideOverlay();
      setBtnLoading(false);
      _closePayModal();
    };
  }

  // Safety: kalau buy modal ditutup (cancel/esc), matikan loading juga
  if (typeof window.closeBuyModal === "function") {
    const _closeBuyModal = window.closeBuyModal;
    window.closeBuyModal = function () {
      token++;
      hideOverlay();
      setBtnLoading(false);
      _closeBuyModal();
    };
  }
})();

/* ========= QRIS Overlay ========= */
const qrisView = qs("#qrisView");
const qrisBigImg = qs("#qrisBigImg");
const closeQrisBtn = qs("#closeQrisBtn");

function openQrisView(){
  if (qrisBigImg) qrisBigImg.src = QRIS_IMAGE_URL;
  qrisView.classList.add("show");
  qrisView.setAttribute("aria-hidden","false");
  lockScroll();
}
function closeQrisView(){
  if (!qrisView?.classList.contains("show")) return;
  qrisView.classList.remove("show");
  qrisView.setAttribute("aria-hidden","true");

  if (!qs("#buyModal")?.classList.contains("show") && !qs("#payModal")?.classList.contains("show") && !mobileMenu?.classList.contains("open")) {
    unlockScroll();
  }
}
closeQrisBtn?.addEventListener("click", closeQrisView, { passive:true });
qrisView?.addEventListener("click", (e)=>{ if(e.target === qrisView) closeQrisView(); }, { passive:true });
qrisHref?.addEventListener("click", (e) => { e.preventDefault(); openQrisView(); }, { passive:false });

/* ========= Init ========= */
document.addEventListener("DOMContentLoaded", () => {
  renderProducts(products);
  applySearch("");
}, { passive:true });
/* ===== FINAL SMOOTH SCROLL V2 (lebih halus, sidebar tunggu nutup dulu) ===== */
(() => {
  const prefersReduce = window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches;

  function navOffset(){
    const nav = document.getElementById("topNav");
    const h = nav ? nav.getBoundingClientRect().height : 0;
    return Math.round(h + 18);
  }

  // rAF smooth scroll (lebih konsisten daripada native smooth di iOS)
  let __raf = 0;
  function animateScrollTo(toY, ms){
    cancelAnimationFrame(__raf);
    const startY = window.pageYOffset || 0;
    const delta = toY - startY;
    if (prefersReduce || Math.abs(delta) < 2){
      window.scrollTo(0, toY);
      return;
    }

    const start = performance.now();
    const dur = Math.max(280, Math.min(ms, 900));

    const ease = (t) => (t < 0.5)
      ? 4 * t * t * t
      : 1 - Math.pow(-2 * t + 2, 3) / 2;

    const step = (now) => {
      const p = Math.min(1, (now - start) / dur);
      window.scrollTo(0, startY + delta * ease(p));
      if (p < 1) __raf = requestAnimationFrame(step);
    };
    __raf = requestAnimationFrame(step);
  }

  function flashTarget(el){
    el.classList.remove("section-flash");
    void el.offsetWidth;
    el.classList.add("section-flash");
    setTimeout(() => el.classList.remove("section-flash"), 850);
  }

  // tunggu sidebar benar-benar selesai animasi tutup
  function closeMenuAfterTransition(cb){
    const menu = document.getElementById("mobileMenu");
    if (!menu || !menu.classList.contains("open")) return cb?.();

    const done = () => {
      menu.removeEventListener("transitionend", done);
      cb?.();
    };

    // fallback kalau transitionend gak kepanggil
    const fallback = setTimeout(done, 360);

    menu.addEventListener("transitionend", () => {
      clearTimeout(fallback);
      done();
    }, { once:true });

    // panggil closeMenu yang sudah ada
    if (typeof window.closeMenu === "function") window.closeMenu();
  }

  function goToHash(id){
    const target = document.querySelector(id);
    if (!target) return;

    document.activeElement?.blur?.();

    // hitung tujuan scroll
    const y = window.pageYOffset + target.getBoundingClientRect().top - navOffset();
    const dist = Math.abs(y - (window.pageYOffset || 0));
    const ms = 380 + Math.min(520, dist * 0.55); // durasi adaptif

    // kalau sidebar lagi open -> tunggu nutup dulu biar gak ‚Äúgeser‚Äù
    closeMenuAfterTransition(() => {
      requestAnimationFrame(() => {
        requestAnimationFrame(() => {
          animateScrollTo(y, ms);
          history.replaceState(null, "", id);
          flashTarget(target);
        });
      });
    });
  }

  // ambil alih semua klik anchor #...
  document.addEventListener("click", (e) => {
    const a = e.target.closest('a[href^="#"]');
    if (!a) return;

    const id = a.getAttribute("href");
    if (!id || id === "#") return;
    if (!document.querySelector(id)) return;

    e.preventDefault();
    e.stopImmediatePropagation();
    goToHash(id);
  }, true);
})();
/* ===== FORCE NAVIGATION FIX (FAQ pasti kebuka) ===== */
(() => {
  const prefersReduce = window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches;

  function navOffset(){
    const nav = document.getElementById("topNav");
    if (!nav) return 170;
    const r = nav.getBoundingClientRect();
    return Math.round(r.bottom + 12); // lebih akurat di iPhone
  }

  function anyOverlayOpen(){
    return (
      document.getElementById("buyModal")?.classList.contains("show") ||
      document.getElementById("payModal")?.classList.contains("show") ||
      document.getElementById("qrisView")?.classList.contains("show") ||
      document.getElementById("mobileMenu")?.classList.contains("open")
    );
  }

  function forceUnlockIfSafe(){
    const isFixed = getComputedStyle(document.body).position === "fixed";
    if (isFixed && !anyOverlayOpen() && typeof window.unlockScroll === "function") {
      window.unlockScroll();
    }
  }

  function scrollToHash(id){
    const target = document.querySelector(id);
    if (!target) return;

    forceUnlockIfSafe();

    const y = window.pageYOffset + target.getBoundingClientRect().top - navOffset();
    const opt = prefersReduce ? { top:y } : { top:y, behavior:"smooth" };
    window.scrollTo(opt);

    // iOS kadang perlu 2x supaya bener-bener nyampe
    setTimeout(() => {
      forceUnlockIfSafe();
      const y2 = window.pageYOffset + target.getBoundingClientRect().top - navOffset();
      const opt2 = prefersReduce ? { top:y2 } : { top:y2, behavior:"smooth" };
      window.scrollTo(opt2);
    }, 140);
  }

  function closeMenuThen(cb){
    const menu = document.getElementById("mobileMenu");
    if (!menu || !menu.classList.contains("open")) return cb();

    let done = false;
    const finish = () => {
      if (done) return;
      done = true;
      menu.removeEventListener("transitionend", finish);
      cb();
    };

    menu.addEventListener("transitionend", finish);
    setTimeout(finish, 420);

    // pakai fungsi yang sudah ada
    if (typeof window.closeMenu === "function") window.closeMenu();
    else menu.classList.remove("open");
  }

  // Tangkap semua klik anchor #... dan PAKSA scroll
  window.addEventListener("click", (e) => {
    const a = e.target.closest('a[href^="#"]');
    if (!a) return;

    const id = a.getAttribute("href");
    if (!id || id === "#") return;
    if (!document.querySelector(id)) return;

    e.preventDefault();
    e.stopImmediatePropagation();

    closeMenuThen(() => {
      // update URL tanpa bikin jump
      history.replaceState(null, "", id);
      requestAnimationFrame(() => requestAnimationFrame(() => scrollToHash(id)));
    });
  }, true);

  // kalau buka link langsung pakai #faq
  window.addEventListener("load", () => {
    if (location.hash && document.querySelector(location.hash)) {
      setTimeout(() => scrollToHash(location.hash), 60);
    }
  }, { passive:true });
})();
/* ===== ANDROID FIX: anchor scroll selalu sampai (auto-correct) ===== */
(() => {
  const prefersReduce = window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches;
  const isAndroid = /Android/i.test(navigator.userAgent);

  function navOffset(){
    const nav = document.getElementById("topNav");
    if (!nav) return 170;
    const r = nav.getBoundingClientRect();
    return Math.round(r.bottom + 12);
  }

  function anyOverlayOpen(){
    return (
      document.getElementById("buyModal")?.classList.contains("show") ||
      document.getElementById("payModal")?.classList.contains("show") ||
      document.getElementById("qrisView")?.classList.contains("show") ||
      document.getElementById("mobileMenu")?.classList.contains("open")
    );
  }

  function forceUnlockIfSafe(){
    const isFixed = getComputedStyle(document.body).position === "fixed";
    if (isFixed && !anyOverlayOpen() && typeof window.unlockScroll === "function") {
      window.unlockScroll();
    }
  }

  function desiredY(el){
    return Math.round(window.pageYOffset + el.getBoundingClientRect().top - navOffset());
  }

  function scrollToEl(el){
    forceUnlockIfSafe();
    const y = desiredY(el);
    if (prefersReduce) window.scrollTo(0, y);
    else window.scrollTo({ top: y, behavior: "smooth" });
    return y;
  }

  // koreksi berkali-kali (khusus Android address bar)
  function settleToEl(el){
    let tries = 0;
    const MAX = isAndroid ? 10 : 6;

    const tick = () => {
      tries++;
      forceUnlockIfSafe();

      const y = desiredY(el);
      const cur = Math.round(window.pageYOffset || 0);
      const diff = y - cur;

      if (Math.abs(diff) <= 3 || tries >= MAX) return;

      // paksa koreksi ke posisi terbaru
      if (prefersReduce) window.scrollTo(0, y);
      else window.scrollTo({ top: y, behavior: "smooth" });

      setTimeout(tick, isAndroid ? 180 : 120);
    };

    setTimeout(tick, isAndroid ? 160 : 120);
  }

  function closeMenuThen(cb){
    const menu = document.getElementById("mobileMenu");
    if (!menu || !menu.classList.contains("open")) return cb();

    let done = false;
    const finish = () => {
      if (done) return;
      done = true;
      menu.removeEventListener("transitionend", finish);
      cb();
    };

    menu.addEventListener("transitionend", finish, { once:true });
    setTimeout(finish, 420);

    if (typeof window.closeMenu === "function") window.closeMenu();
    else menu.classList.remove("open");
  }

  function goToHash(id){
    const el = document.querySelector(id);
    if (!el) return;

    closeMenuThen(() => {
      document.activeElement?.blur?.();
      history.replaceState(null, "", id);

      // 1) scroll awal
      scrollToEl(el);

      // 2) auto-correct sampai benar-benar nyampe
      settleToEl(el);
    });
  }

  // Ambil alih semua klik anchor #...
  window.addEventListener("click", (e) => {
    const a = e.target.closest('a[href^="#"]');
    if (!a) return;

    const id = a.getAttribute("href");
    if (!id || id === "#") return;
    if (!document.querySelector(id)) return;

    e.preventDefault();
    e.stopImmediatePropagation();
    goToHash(id);
  }, true);

})();
</script>
</body>
</html>
